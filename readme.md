# 比赛用图像压缩

### 性能比较



| 算法                  | sample01.bmp | sample02.bmp | sample03.bmp |
|:--------------------|:-------------|:-------------|:-------------|
| LZMA                | 7.08032%     | 16.7472%     | 53.901%      |
| JPEG-LS（含头）         | 21.8635%     | 33.6453%     | 49.2618%     |
| JPEG-LS（含头） + LZMA  | 23.8156%     | 35.8255%     | 51.1689%     |
| JPEG-LS（不含头）        | 5.45728%     | 17.239%      | 32.8556%     |
| JPEG-LS（不含头） + LZMA | 9.65596%     | 21.8506%      | 39.1786%     |
| 混合（JPEG-LS（不含头）、LZMA）   | 4.92183%     | 14.9336%      | 33.2063%     |

### 纯透明空块压缩效果（8\*8\*4bytes）

| 算法             | 原始大小为256 |
|:---------------|:---------|
| LZMA           | 13       |
| JPEG-LS（含头）    | 45       |
| JPEG-LS（含头） + LZMA | 13       |
| JPEG-LS（不含头）    | 3        |
| JPEG-LS（不含头） + LZMA |          |

在压缩数据较少使LZMA再压缩会导致数据反而变大。

通用算法容器
当块长度小于255时，则采用如下的压缩方法：
| 字节数          | 说明          |
|:-------------|:------------|
| 1            | 算法编号(type)        |
| 不定            | 采用对应压缩算法得到的压缩数据      |
当块长度为256时，图片未经压缩，直接写入数据。

算法1（适用于普通的图片）
采用JPEG-LS（不含头）

算法2（适用复杂通用情况）
采用LZMA压缩

算法3（复合，测试下仅少量可压缩）
采用JPEG-LS（不含头）压缩，再采用LZMA压缩

算法4（适用于空白块）
仅做标记，无任何数据，代表所有数据均为0x00

算法5（猜测适用于连续色块且颜色种类多，未实现）
将相同的像素压缩为size(1byte)和color(4byte)，如此直至块结束

算法6（猜测适用于颜色少的大量重复颜色块，未实现）
将出现的颜色编写为字典（index(1byte)和color(4byte)，通过重复的index判断是否开始编码），将颜色块压缩为index(1byte)和size(1byte)，如此直至块结束

混合算法表现
| 样本       | 混合算法（算法1-4）压缩率      | JPEG-LS压缩率      |
|:---------|:---------|:---------|
|sample01.bmp|4.92183%|5.45728%|
|sample02.bmp|14.93360%|17.19460%|
|sample03.bmp|33.20630%|32.85560%|
|sample04.bmp|38.64590%|38.47870%|
|sample05.bmp|33.47520%|33.35090%|
|sample06.bmp|46.82360%|46.44330%|
|sample07.bmp|43.66400%|43.46690%|
|sample08.bmp|48.21690%|48.44520%|
|sample09.bmp|47.90570%|47.91580%|
|sample10.bmp|25.48600%|25.38190%|
|sample11.bmp|22.28420%|22.40730%|
|sample12.bmp|35.62320%|35.40230%|
|sample13.bmp|46.65580%|46.83250%|
|sample14.bmp|24.87180%|25.38350%|
|sample15.bmp|44.07240%|43.98670%|
|sample16.bmp|25.56100%|25.76150%|
|sample17.bmp|32.03470%|32.51870%|
|sample18.bmp|19.69740%|19.99990%|
|sample19.bmp|37.68850%|37.91250%|
|sample20.bmp|32.48080%|32.48480%|
|sample21.bmp|13.65240%|17.13420%|
|sample22.bmp|9.05552%|10.81000%|
|sample23.bmp|17.02700%|17.31870%|
|sample24.bmp|14.05350%|14.89950%|
|sample25.bmp|40.25190%|40.09820%|
|sample26.bmp|56.46490%|56.14740%|
|sample27.bmp|43.19510%|43.20820%|
|sample28.bmp|39.28440%|39.32290%|
|sample29.bmp|50.22790%|49.94100%|
|sample30.bmp|48.96670%|48.62120%|
|sample31.bmp|51.81080%|52.15610%|
|sample32.bmp|21.24930%|23.08730%|
|sample33.bmp|60.68550%|60.99980%|
|平均压缩率|34.04562%|34.41%|
|最大压缩率|4.92183%|5.45728%|
|最小压缩率|60.68550%|60.99980%|




